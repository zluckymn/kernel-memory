# Configuring Agents with Semantic Kernel Plugins 使用Semantic Kernel插件配置代理

- 05/23/2025



This feature is in the release candidate stage. Features at this stage are nearly complete and generally stable, though they may undergo minor refinements or optimizations before reaching full general availability.
此功能处于候选版本阶段。此阶段的功能几乎完整且总体稳定，尽管在完全正式发布之前可能会进行一些细微的改进或优化。



## Functions and Plugins in Semantic Kernel Semantic Kernel中的函数和插件

Function calling is a powerful tool that allows developers to add custom functionalities and expand the capabilities of AI applications. The Semantic Kernel [Plugin](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/) architecture offers a flexible framework to support [Function Calling](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/function-calling/). For an `Agent`, integrating [Plugins](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/) and [Function Calling](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/function-calling/) is built on this foundational Semantic Kernel feature.
函数调用是一个强大的工具，允许开发人员添加自定义功能并扩展 AI 应用程序的功能。Semantic Kernel[插件](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/)架构提供了一个灵活的框架来支持[函数调用 ](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/function-calling/)。对于`代理`来说，[ 集成插件](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/)和[函数调用](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/function-calling/)是建立在这一基本Semantic Kernel功能之上的。

Once configured, an agent will choose when and how to call an available function, as it would in any usage outside of the `Agent Framework`.
配置完成后，代理将选择何时以及如何调用可用函数，就像在`代理框架`之外的任何用法中一样。

 Tip  提示

API reference:  API 参考：

- [`KernelFunctionFactory`](https://learn.microsoft.com/en-us/dotnet/api/microsoft.semantickernel.kernelfunctionfactory)
- [`KernelFunction`](https://learn.microsoft.com/en-us/dotnet/api/microsoft.semantickernel.kernelfunction)
- [`KernelPluginFactory`](https://learn.microsoft.com/en-us/dotnet/api/microsoft.semantickernel.kernelpluginfactory)
- [`KernelPlugin`](https://learn.microsoft.com/en-us/dotnet/api/microsoft.semantickernel.kernelplugin)
- [`Kernel.Plugins`](https://learn.microsoft.com/en-us/dotnet/api/microsoft.semantickernel.kernel.plugins)



## Adding Plugins to an Agent 将插件添加到代理

Any [Plugin](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/) available to an `Agent` is managed within its respective `Kernel` instance. This setup enables each `Agent` to access distinct functionalities based on its specific role.
`代理`可用的任何[插件](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/)都在其各自的`内核`实例中进行管理。此设置使每个`代理`能够根据其特定角色访问不同的功能。

[Plugins](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/) can be added to the `Kernel` either before or after the `Agent` is created. The process of initializing [Plugins](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/) follows the same patterns used for any Semantic Kernel implementation, allowing for consistency and ease of use in managing AI capabilities.
[插件](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/)可以在创建`代理`之前或之后添加到`内核`中。初始[化插件](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/)的过程遵循与任何Semantic Kernel实现相同的模式，从而在管理 AI 功能时保持一致性和易用性。

 Note  注意

For a [`ChatCompletionAgent`](https://learn.microsoft.com/en-us/semantic-kernel/frameworks/agent/agent-types/chat-completion-agent), the function calling mode must be explicitly enabled. [`OpenAIAssistant`](https://learn.microsoft.com/en-us/semantic-kernel/frameworks/agent/agent-types/assistant-agent) agent is always based on automatic function calling.
对于 [`ChatCompletionAgent`](https://learn.microsoft.com/en-us/semantic-kernel/frameworks/agent/agent-types/chat-completion-agent)，必须显式启用函数调用模式。[`OpenAIAssistant`](https://learn.microsoft.com/en-us/semantic-kernel/frameworks/agent/agent-types/assistant-agent) 代理始终基于自动函数调用。

C#Copy  复制

```csharp
// Factory method to product an agent with a specific role.
// Could be incorporated into DI initialization.
ChatCompletionAgent CreateSpecificAgent(Kernel kernel, string credentials)
{
    // Clone kernel instance to allow for agent specific plug-in definition
    Kernel agentKernel = kernel.Clone();

    // Import plug-in from type
    agentKernel.ImportPluginFromType<StatelessPlugin>();

    // Import plug-in from object
    agentKernel.ImportPluginFromObject(new StatefulPlugin(credentials));

    // Create the agent
    return
        new ChatCompletionAgent()
        {
            Name = "<agent name>",
            Instructions = "<agent instructions>",
            Kernel = agentKernel,
            Arguments = new KernelArguments(
                new OpenAIPromptExecutionSettings()
                {
                    FunctionChoiceBehavior = FunctionChoiceBehavior.Auto()
                })
        };
}
```



## Adding Functions to an Agent 向代理添加函数

A [Plugin](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/) is the most common approach for configuring [Function Calling](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/function-calling/). However, individual functions can also be supplied independently including prompt functions.
[插件](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/)是配置[函数调用](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/function-calling/)的最常见方法。但是，也可以独立提供单个功能，包括提示功能。

C#Copy  复制

```csharp
// Factory method to product an agent with a specific role.
// Could be incorporated into DI initialization.
ChatCompletionAgent CreateSpecificAgent(Kernel kernel)
{
    // Clone kernel instance to allow for agent specific plug-in definition
    Kernel agentKernel = kernel.Clone();

    // Create plug-in from a static function
    var functionFromMethod = agentKernel.CreateFunctionFromMethod(StatelessPlugin.AStaticMethod);

    // Create plug-in from a prompt
    var functionFromPrompt = agentKernel.CreateFunctionFromPrompt("<your prompt instructions>");

    // Add to the kernel
    agentKernel.ImportPluginFromFunctions("my_plugin", [functionFromMethod, functionFromPrompt]);

    // Create the agent
    return
        new ChatCompletionAgent()
        {
            Name = "<agent name>",
            Instructions = "<agent instructions>",
            Kernel = agentKernel,
            Arguments = new KernelArguments(
                new OpenAIPromptExecutionSettings()
                {
                    FunctionChoiceBehavior = FunctionChoiceBehavior.Auto()
                })
        };
}
```



## Limitations for Agent Function Calling 代理函数调用的限制

When directly invoking a[`ChatCompletionAgent`](https://learn.microsoft.com/en-us/semantic-kernel/frameworks/agent/agent-types/chat-completion-agent), all Function Choice Behaviors are supported. However, when using an [`OpenAIAssistant`](https://learn.microsoft.com/en-us/semantic-kernel/frameworks/agent/agent-types/assistant-agent), only Automatic [Function Calling](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/function-calling/) is currently available.
直接调用 [`ChatCompletionAgent`](https://learn.microsoft.com/en-us/semantic-kernel/frameworks/agent/agent-types/chat-completion-agent) 时，支持所有函数选择行为。但是，使用 [`OpenAIAssistant`](https://learn.microsoft.com/en-us/semantic-kernel/frameworks/agent/agent-types/assistant-agent) 时，当前只有自动[函数调用](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/function-calling/)可用。



## How-To  作方法

For an end-to-end example for using function calling, see:
有关使用函数调用的端到端示例，请参阅：

- [How-To: `ChatCompletionAgent`
  作方法：`ChatCompletionAgent`](https://learn.microsoft.com/en-us/semantic-kernel/frameworks/agent/examples/example-chat-agent)



## Next steps  后续步骤

[  如何流式传输代理响应](https://learn.microsoft.com/en-us/semantic-kernel/frameworks/agent/agent-streaming)