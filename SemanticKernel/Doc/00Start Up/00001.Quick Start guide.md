# Getting started with Semantic Kernel Semantic Kernel入门

- 11/09/2024



In just a few steps, you can build your first AI agent with Semantic Kernel in either Python, .NET, or Java. This guide will show you how to...
只需几个步骤，您就可以在 Python、.NET 或 Java 中使用Kernel构建您的第一个 AI 代理。本指南将向您展示如何...

- Install the necessary packages
  安装必要的软件包
- Create a back-and-forth conversation with an AI
  与 AI 创建来回对话
- Give an AI agent the ability to run your code
  让 AI 代理能够运行代码
- Watch the AI create plans on the fly
  观看 AI 即时制定计划



## Installing the SDK  安装 SDK

Semantic Kernel has several NuGet packages available. For most scenarios, however, you typically only need `Microsoft.SemanticKernel`.
Kernel有多个可用的 NuGet 包。但是，对于大多数方案，通常只需要 `Microsoft.SemanticKernel`。

You can install it using the following command:
您可以使用以下命令安装它：

Bash  猛击Copy  复制

```bash
dotnet add package Microsoft.SemanticKernel
```

For the full list of Nuget packages, please refer to the [supported languages article](https://learn.microsoft.com/en-us/semantic-kernel/get-started/supported-languages).
有关 Nuget 包的完整列表，请参阅[支持的语言一文 ](https://learn.microsoft.com/en-us/semantic-kernel/get-started/supported-languages)。



## Quickly get started with notebooks 快速开始使用笔记本

If you're a Python or C# developer, you can quickly get started with our notebooks. These notebooks provide step-by-step guides on how to use Semantic Kernel to build AI agents.
如果您是 Python 或 C# 开发人员，您可以快速开始使用我们的笔记本。这些笔记本提供了有关如何使用Kernel构建 AI 代理的分步指南。

![Semantic Kernel notebooks](https://learn.microsoft.com/en-us/semantic-kernel/media/python_getting_started_notebooks.png)

To get started, follow these steps:
首先，请按照下列步骤作：

1. Clone the [Semantic Kernel repo](https://github.com/microsoft/semantic-kernel)
   克隆[Kernel存储库](https://github.com/microsoft/semantic-kernel)
2. Open the repo in Visual Studio Code
   在 Visual Studio Code 中打开存储库
3. Navigate to [_/dotnet/notebooks](https://github.com/microsoft/semantic-kernel/tree/main/dotnet/notebooks)
   导航到 [_/dotnet/notebooks](https://github.com/microsoft/semantic-kernel/tree/main/dotnet/notebooks)
4. Open *00-getting-started.ipynb* to get started setting your environment and creating your first AI agent!
   打开 *00-getting-started.ipynb* 开始设置您的环境并创建您的第一个 AI 代理！



## Writing your first console app 编写第一个控制台应用

1. Create a new .NET Console project using this command:
   使用以下命令创建新的 .NET 控制台项目：

Bash  猛击Copy  复制

```bash
dotnet new console
```

1. Install the following .NET dependencies:
   安装以下 .NET 依赖项：

Bash  猛击Copy  复制

```bash
dotnet add package Microsoft.SemanticKernel
dotnet add package Microsoft.Extensions.Logging
dotnet add package Microsoft.Extensions.Logging.Console
```

1. Replace the content of the `Program.cs` file with this code:
   将 `Program.cs` 文件的内容替换为以下代码：

C#Copy  复制

```csharp
// Import packages
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Logging;
using Microsoft.SemanticKernel;
using Microsoft.SemanticKernel.ChatCompletion;
using Microsoft.SemanticKernel.Connectors.OpenAI;

// Populate values from your OpenAI deployment
var modelId = "";
var endpoint = "";
var apiKey = "";

// Create a kernel with Azure OpenAI chat completion
var builder = Kernel.CreateBuilder().AddAzureOpenAIChatCompletion(modelId, endpoint, apiKey);

// Add enterprise components
builder.Services.AddLogging(services => services.AddConsole().SetMinimumLevel(LogLevel.Trace));

// Build the kernel
Kernel kernel = builder.Build();
var chatCompletionService = kernel.GetRequiredService<IChatCompletionService>();

// Add a plugin (the LightsPlugin class is defined below)
kernel.Plugins.AddFromType<LightsPlugin>("Lights");

// Enable planning
OpenAIPromptExecutionSettings openAIPromptExecutionSettings = new() 
{
    FunctionChoiceBehavior = FunctionChoiceBehavior.Auto()
};

// Create a history store the conversation
var history = new ChatHistory();

// Initiate a back-and-forth chat
string? userInput;
do {
    // Collect user input
    Console.Write("User > ");
    userInput = Console.ReadLine();

    // Add user input
    history.AddUserMessage(userInput);

    // Get the response from the AI
    var result = await chatCompletionService.GetChatMessageContentAsync(
        history,
        executionSettings: openAIPromptExecutionSettings,
        kernel: kernel);

    // Print the results
    Console.WriteLine("Assistant > " + result);

    // Add the message from the agent to the chat history
    history.AddMessage(result.Role, result.Content ?? string.Empty);
} while (userInput is not null);
```

The following back-and-forth chat should be similar to what you see in the console. The function calls have been added below to demonstrate how the AI leverages the plugin behind the scenes.
以下来回聊天应类似于您在控制台中看到的内容。下面添加了函数调用，以演示 AI 如何在幕后利用插件。

  展开表

| Role  角色                                               | Message  消息                    |
| :------------------------------------------------------- | :------------------------------- |
| 🔵 **User**  🔵 **用户**                                   | Please toggle the light 请切换灯 |
| 🔴 **Assistant (function call)** 🔴 **助手 （函数 调用）** | `LightsPlugin.GetState()`        |
| 🟢 **Tool**  🟢 **工具**                                   | `off`                            |
| 🔴 **Assistant (function call)** 🔴 **助手 （函数 调用）** | `LightsPlugin.ChangeState(true)` |
| 🟢 **Tool**  🟢 **工具**                                   | `on`                             |
| 🔴 **Assistant**  🔴 **助理**                              | The light is now on 现在灯亮了   |

If you're interested in understanding more about the code above, we'll break it down in the next section.
如果您有兴趣了解有关上述代码的更多信息，我们将在下一节中对其进行分解。



## Understanding the code  了解代码

To make it easier to get started building enterprise apps with Semantic Kernel, we've created a step-by-step that guides you through the process of creating a kernel and using it to interact with AI services.
为了更轻松地开始使用Kernel构建企业应用，我们创建了一个分步指南，指导您完成创建内核并使用它与 AI 服务交互的过程。

![Semantic Kernel DotNET map](https://learn.microsoft.com/en-us/semantic-kernel/media/dotnetmap.png)

In the following sections, we'll unpack the above sample by walking through steps **1**, **2**, **3**, **4**, **6**, **9**, and **10**. Everything you need to build a simple agent that is powered by an AI service and can run your code.
在以下部分中，我们将通过演练步骤 **1**、**2**、**3**、**4**、**6**、**9** 和 **10** 来解压缩上述示例。构建由 AI 服务提供支持并可以运行代码的简单代理所需的一切。

- [Import packages  导入包](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#1-import-packages)
- [Add AI services  添加 AI 服务](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#2-add-ai-services)
- [Enterprise components  企业组件](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#3-add-enterprise-services)
- [Build the kernel  构建内核](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#4-build-the-kernel-and-retrieve-services)
- Add memory (skipped)  添加内存（跳过）
- [Add plugins  添加插件](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#6-add-plugins)
- Create kernel arguments (skipped)
  创建内核参数（跳过）
- Create prompts (skipped)
  创建提示（跳过）
- [Planning  规划](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#9-planning)
- [Invoke  调用](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#10-invoke)



### 1) Import packages  1） 导入包

For this sample, we first started by importing the following packages:
对于此示例，我们首先导入以下包：

C#Copy  复制

```csharp
using Microsoft.SemanticKernel;
using Microsoft.SemanticKernel.ChatCompletion;
using Microsoft.SemanticKernel.Connectors.OpenAI;
```



### 2) Add AI services  2）添加 AI 服务

Afterwards, we add the most important part of a kernel: the AI services that you want to use. In this example, we added an Azure OpenAI chat completion service to the kernel builder.
之后，我们添加内核中最重要的部分：您要使用的 AI 服务。在此示例中，我们将 Azure OpenAI 聊天完成服务添加到内核生成器。

 Note  注意

In this example, we used Azure OpenAI, but you can use any other chat completion service. To see the full list of supported services, refer to the [supported languages article](https://learn.microsoft.com/en-us/semantic-kernel/get-started/supported-languages). If you need help creating a different service, refer to the [AI services article](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/). There, you'll find guidance on how to use OpenAI or Azure OpenAI models as services.
在此示例中，我们使用了 Azure OpenAI，但可以使用任何其他聊天完成服务。若要查看受支持服务的完整列表，请参阅[支持的语言一文 ](https://learn.microsoft.com/en-us/semantic-kernel/get-started/supported-languages)。如果需要创建其他服务的帮助，请参阅 [AI 服务一文 ](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/)。在那里，你将找到有关如何使用 OpenAI 或 Azure OpenAI 模型作为服务的指南。

C#Copy  复制

```csharp
// Create kernel
var builder = Kernel.CreateBuilder()
builder.AddAzureOpenAIChatCompletion(modelId, endpoint, apiKey);
```



### 3) Add enterprise services 3）添加企业服务

One of the main benefits of using Semantic Kernel is that it supports enterprise-grade services. In this sample, we added the logging service to the kernel to help debug the AI agent.
使用Kernel的主要好处之一是它支持企业级服务。在此示例中，我们将日志记录服务添加到内核中，以帮助调试 AI 代理。

C#Copy  复制

```csharp
builder.Services.AddLogging(services => services.AddConsole().SetMinimumLevel(LogLevel.Trace));
```



### 4) Build the kernel and retrieve services 4）构建内核并检索服务

Once the services have been added, we then build the kernel and retrieve the chat completion service for later use.
添加服务后，我们构建内核并检索聊天完成服务以供以后使用。

C#Copy  复制

```csharp
Kernel kernel = builder.Build();

// Retrieve the chat completion service
var chatCompletionService = kernel.Services.GetRequiredService<IChatCompletionService>();
```



### 6) Add plugins  6）添加插件

With plugins, can give your AI agent the ability to run your code to retrieve information from external sources or to perform actions. In the above example, we added a plugin that allows the AI agent to interact with a light bulb. Below, we'll show you how to create this plugin.
使用插件，可以让您的 AI 代理能够运行您的代码以从外部源检索信息或执行作。在上面的示例中，我们添加了一个插件，允许 AI 代理与灯泡交互。下面，我们将向您展示如何创建此插件。



#### Create a native plugin  创建原生插件

Below, you can see that creating a native plugin is as simple as creating a new class.
下面，你可以看到创建原生插件就像创建一个新类一样简单。

In this example, we've created a plugin that can manipulate a light bulb. While this is a simple example, this plugin quickly demonstrates how you can support both...
在这个例子中，我们创建了一个可以纵灯泡的插件。虽然这是一个简单的示例，但此插件快速演示了如何同时支持两者......

1. [Retrieval Augmented Generation (RAG)](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/using-data-retrieval-functions-for-rag) by providing the AI agent with the state of the light bulb
   [检索增强生成 （RAG）](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/using-data-retrieval-functions-for-rag) 通过向 AI 代理提供灯泡的状态
2. And [task automation](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/using-task-automation-functions) by allowing the AI agent to turn the light bulb on or off.
   以及通过允许 AI 代理打开或关闭灯泡来实现[任务自动化 ](https://learn.microsoft.com/en-us/semantic-kernel/concepts/plugins/using-task-automation-functions)。

In your own code, you can create a plugin that interacts with any external service or API to achieve similar results.
在您自己的代码中，您可以创建一个与任何外部服务或 API 交互的插件，以实现类似的结果。

C#Copy  复制

```csharp
using System.ComponentModel;
using System.Text.Json.Serialization;
using Microsoft.SemanticKernel;

public class LightsPlugin
{
   // Mock data for the lights
   private readonly List<LightModel> lights = new()
   {
      new LightModel { Id = 1, Name = "Table Lamp", IsOn = false },
      new LightModel { Id = 2, Name = "Porch light", IsOn = false },
      new LightModel { Id = 3, Name = "Chandelier", IsOn = true }
   };

   [KernelFunction("get_lights")]
   [Description("Gets a list of lights and their current state")]
   public async Task<List<LightModel>> GetLightsAsync()
   {
      return lights;
   }

   [KernelFunction("change_state")]
   [Description("Changes the state of the light")]
   public async Task<LightModel?> ChangeStateAsync(int id, bool isOn)
   {
      var light = lights.FirstOrDefault(light => light.Id == id);

      if (light == null)
      {
         return null;
      }

      // Update the light with the new state
      light.IsOn = isOn;

      return light;
   }
}

public class LightModel
{
   [JsonPropertyName("id")]
   public int Id { get; set; }

   [JsonPropertyName("name")]
   public string Name { get; set; }

   [JsonPropertyName("is_on")]
   public bool? IsOn { get; set; }
}
```



#### Add the plugin to the kernel 将插件添加到内核

Once you've created your plugin, you can add it to the kernel so the AI agent can access it. In the sample, we added the `LightsPlugin` class to the kernel.
创建插件后，您可以将其添加到内核中，以便 AI 代理可以访问它。在示例中，我们将 `LightsPlugin` 类添加到内核中。

C#Copy  复制

```csharp
// Add the plugin to the kernel
kernel.Plugins.AddFromType<LightsPlugin>("Lights");
```



### 9) Planning  9） 规划

Semantic Kernel leverages [function calling](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/function-calling/)–a native feature of most LLMs–to provide [planning](https://learn.microsoft.com/en-us/semantic-kernel/concepts/planning). With function calling, LLMs can request (or call) a particular function to satisfy a user's request. Semantic Kernel then marshals the request to the appropriate function in your codebase and returns the results back to the LLM so the AI agent can generate a final response.
Kernel利用[函数调用 ](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/function-calling/)（大多数 LLM 的原生功能）来提供[规划 ](https://learn.microsoft.com/en-us/semantic-kernel/concepts/planning)。通过函数调用，LLM 可以请求（或调用）特定函数来满足用户的请求。然后，Kernel将请求封送到代码库中的相应函数，并将结果返回给 LLM，以便 AI 代理可以生成最终响应。

To enable automatic function calling, we first need to create the appropriate execution settings so that Semantic Kernel knows to automatically invoke the functions in the kernel when the AI agent requests them.
要启用自动函数调用，我们首先需要创建适当的执行设置，以便Kernel知道在 AI 代理请求时自动调用内核中的函数。

C#Copy  复制

```csharp
OpenAIPromptExecutionSettings openAIPromptExecutionSettings = new()
{
    FunctionChoiceBehavior = FunctionChoiceBehavior.Auto()
};
```



### 10) Invoke  10） 调用

Finally, we invoke the AI agent with the plugin. The sample code demonstrates how to generate a [non-streaming response](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/#non-streaming-chat-completion), but you can also generate a [streaming response](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/#streaming-chat-completion) by using the `GetStreamingChatMessageContentAsync` method.
最后，我们使用插件调用 AI 代理。示例代码演示了如何生成[非流式处理响应 ](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/#non-streaming-chat-completion)，但您也可以使用该 `GetStreamingChatMessageContentAsync` 方法生成[流式处理响应 ](https://learn.microsoft.com/en-us/semantic-kernel/concepts/ai-services/chat-completion/#streaming-chat-completion)。

C#Copy  复制

```csharp
// Create chat history
var history = new ChatHistory();

// Get the response from the AI
var result = await chatCompletionService.GetChatMessageContentAsync(
    history,
    executionSettings: openAIPromptExecutionSettings,
    kernel: kernel
);
```

Run the program using this command:
使用以下命令运行程序：

Bash  猛击Copy  复制

```bash
dotnet run
```



## Next steps  后续步骤

In this guide, you learned how to quickly get started with Semantic Kernel by building a simple AI agent that can interact with an AI service and run your code. To see more examples and learn how to build more complex AI agents, check out our [in-depth samples](https://learn.microsoft.com/en-us/semantic-kernel/get-started/detailed-samples).
在本指南中，你学习了如何通过构建一个简单的 AI 代理来快速开始使用Kernel，该代理可以与 AI 服务交互并运行您的代码。要查看更多示例并了解如何构建更复杂的 AI 代理，请查看我们的[深入示例 ](https://learn.microsoft.com/en-us/semantic-kernel/get-started/detailed-samples)。







------

## Additional resources   其他资源

Documentation  文档

- [Introduction to Semantic Kernel
  Kernel简介](https://learn.microsoft.com/en-us/semantic-kernel/overview/?source=recommendations)

  Learn about Semantic Kernel
  了解Kernel

- [In-depth Semantic Kernel Demos
  深入的Kernel演示](https://learn.microsoft.com/en-us/semantic-kernel/get-started/detailed-samples?source=recommendations)

  Go deeper with additional Demos to learn how to use Semantic Kernel.
  通过其他演示深入了解如何使用Kernel。

- [Supported languages for Semantic Kernel
  Kernel支持的语言](https://learn.microsoft.com/en-us/semantic-kernel/get-started/supported-languages?source=recommendations)

  Learn which features are available for C#, Python, and Java.
  了解哪些功能可用于 C#、Python 和 Java。

Show 3 more  显示 3 个

Training  训练

Module  模块

[Run prompts with Semantic Kernel - Training
使用Kernel运行提示 - 训练](https://learn.microsoft.com/en-us/training/modules/create-plugins-semantic-kernel/?source=recommendations)

This module explores Semantic Kernel SDK plugins. Learn how plugins to the SDK are used to accomplish customized tasks and create intelligent applications.
本模块探讨Kernel SDK 插件。了解如何使用 SDK 插件来完成自定义任务和创建智能应用程序。

In this article  本文内容[Installing the SDK
安装 SDK](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#installing-the-sdk)[Quickly get started with notebooks
快速开始使用笔记本](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#quickly-get-started-with-notebooks)[Writing your first console app
编写第一个控制台应用](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#writing-your-first-console-app)[Understanding the code
了解代码](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#understanding-the-code)[Next step](https://learn.microsoft.com/en-us/semantic-kernel/get-started/quick-start-guide?pivots=programming-language-csharp#next-steps)